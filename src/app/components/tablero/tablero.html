<div class="board-container" (touchstart)="$event.preventDefault()">

  <canvas #pizarra 
          class="whiteboard-canvas"
          (contextmenu)="$event.preventDefault()"
          (selectstart)="$event.preventDefault()">
  </canvas>

  <div *ngFor="let cursor of cursoresRemotos | keyvalue" 
       class="remote-cursor"
       [style.left.px]="(cursor.value.x * scale) + offsetX"
       [style.top.px]="(cursor.value.y * scale) + offsetY">
    
    <svg width="24" height="24" viewBox="0 0 24 24" [style.fill]="cursor.value.color">
      <path d="M5.5 3.21l12.32 12.32-4.59 1.09 3.94 3.94-1.41 1.41-3.94-3.94-1.09 4.59z" stroke="white" stroke-width="1"/>
    </svg>
    <div class="cursor-label">{{ cursor.value.usuario }}</div>
  </div>

  <div class="floating-panel top-left glass-effect">
    <button class="icon-btn" (click)="irAlHome()" title="Volver">
      â¬…
    </button>
    <div class="divider-vertical"></div>
    <div class="room-info">
      <span class="label">Sala</span>
      <span class="value">{{ salaId }}</span>
    </div>
  </div>

  <div class="floating-panel top-center glass-effect pill-shape">
    <button class="pill-btn" (click)="toggleModo(false)" [class.active]="!modoMover">
      âœï¸ Dibujar
    </button>
    <button class="pill-btn" (click)="toggleModo(true)" [class.active]="modoMover">
      ğŸ–ï¸ Mover
    </button>
  </div>

  <div class="floating-panel bottom-center glass-effect">
    
    <div class="tool-group">
      <div class="color-wrapper" [style.background-color]="colorActual">
        <input type="color" [(ngModel)]="colorActual" title="Color">
      </div>
    </div>

    <div class="tool-group range-group">
      <span class="tool-label">Grosor</span>
      <input type="range" min="1" max="30" [(ngModel)]="grosor">
    </div>

    <div class="divider-vertical"></div>

    <div class="tool-group actions">
      <button class="icon-btn" (click)="deshacer()" title="Deshacer">â†©ï¸</button>
      <button class="icon-btn" (click)="rehacer()" title="Rehacer">â†ªï¸</button>
    </div>

    <div class="divider-vertical"></div>

    <button class="icon-btn" (click)="activarBorrador()" title="Borrador">ğŸ§½</button>
    <button class="icon-btn" (click)="descargarImagen()" title="Guardar">ğŸ’¾</button>
    <button class="icon-btn danger" (click)="borrarTodo()" title="Limpiar">ğŸ—‘ï¸</button>
  </div>

  <div class="floating-panel bottom-left glass-effect column-layout">
    <button class="zoom-btn" (click)="cambiarZoom(0.1)">+</button>
    <div class="zoom-display">{{ (scale * 100) | number:'1.0-0' }}%</div>
    <button class="zoom-btn" (click)="cambiarZoom(-0.1)">-</button>
  </div>

  <div *ngIf="modoMover" class="floating-toast">
    Arrastra para moverte
  </div>

</div>